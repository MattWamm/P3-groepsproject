@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/EigenMaaltijd.css"/>
    <link rel="stylesheet" href="~/css/popup.css"/>
    <link rel="stylesheet" href="~/css/site.css"/>
    <script src="lib/jquery/dist/jquery.js"></script>
    <title>Home</title>
</head>

<body>

    <div class="container-fluid" id="container_index_1">
        <nav class="navbar navbar-expand" id="nav">
            <a class="navbar-brand" asp-page="/Index"><img src="~/img/Testlogo.png" height="35" width="140" alt="Testlogo EigenMaaltijd" id="Testlogo" /></a>

            <form class="form" id="form_zoekbalk" method="post" asp-page-handler="Search" asp-page="/ZoekMaaltijd">
                <input class="form-control" type="search" placeholder="Zoeken naar gerecht..." id="input_zoekbalk" asp-for="SearchTerm">
            </form>
            <a class="navbar" id="aanmelden" asp-page="/Inloggen"><img src="~/img/Profiellogo.png" height="20" width="20" alt="Logo Mijn Profiel" id="Profiellogo" /> &nbsp Aanmelden</a>

        </nav>
    </div>

    <div class="container-fluid" id="container_index_2">
        <h1>Welkom bij EigenMaaltijd.</h1>
    </div>

    <div class="container-fluid" id="container_index_3">

        <div class="row no-gutters" >
            @foreach (IndexMeal IMeal in Model.IMeals)
            {
                    <div class="col col-lg-3">
                        <div class="hover-container">
                            <img class="img-fluid" src="@IMeal.img64Url" id="img_maaltijd" style=" width: 100px; height: 200px; object-fit: cover; "/>
                            <div class="hover-content" id="@IMeal.meal.MealID.ToString()">
                                    <p class="maaltijd_beschrijving">
                                            <b> @IMeal.meal.Name</b>  <br>
                                            @IMeal.user.Adres<br>
                                            @IMeal.meal.Rating <br /><br />
                                            <button type="submit"></button>
                                    </p>
                            </div>
                        </div>
                    </div>
            }
        </div>
    </div>

    <div class="popup" id="popup">

        <div class="popup-content" id="popup_content">

            <div class="grid-container">
                <div class="grid-item-1">
                    <h2 class="titel">Stampot boerenkool met rookworst</h2>
                    <div style="margin-left: 70px" class="rate">
                        <input type="radio" id="star5" name="rate" value="5" />
                        <label for="star5" title="text">5 stars</label>
                        <input type="radio" id="star4" name="rate" value="4" />
                        <label for="star4" title="text">4 stars</label>
                        <input type="radio" id="star3" name="rate" value="3" />
                        <label for="star3" title="text">3 stars</label>
                        <input type="radio" id="star2" name="rate" value="2" />
                        <label for="star2" title="text">2 stars</label>
                        <input type="radio" id="star1" name="rate" value="1" />
                        <label for="star1" title="text">1 star</label>
                    </div><p>6,2/10 (13 Reviews)</p>
                </div>

                <div class="grid-item-2"></div>
                <div class="grid-item-3">
                    <form method="post">
                        <button type="submit" id="btn_close" class="close" name="close" asp-page-handler="Close">
                            <span aria-hidden="false" name="close">&times;</span>
                        </button>
                    </form>
                </div>

                <div class="grid-item-4">
                    <img class="Gerecht" src="~/img/Hutspot.png" width="700" height="500">
                </div>

                <div class="grid-item-5">
                    <h2>Stampot boerenkool met rookworst</h2>
                    <p>Ingredienten:</p>

                    <ul>
                        @{
                            if (Model.ClickedMeal.Ingredients != null)
                                foreach (string ingredient in Model.ClickedMeal.Ingredients)
                                {
                                    <li>@ingredient</li>
                                }
                        }
                    </ul>
                    <p>€ per portie</p>
                    <h4>Aantal porties:</h4>
                    <form class="Bestellen">
                        <input type="number" id="quantity" name="quantity" min="1" max="">
                        <input type="submit" name="Bestellen">
                    </form>
                    <div class="rate">
                        <input type="radio" id="star5" name="rate" value="5" />
                        <label for="star5" title="text">5 stars</label>
                        <input type="radio" id="star4" name="rate" value="4" />
                        <label for="star4" title="text">4 stars</label>
                        <input type="radio" id="star3" name="rate" value="3" />
                        <label for="star3" title="text">3 stars</label>
                        <input type="radio" id="star2" name="rate" value="2" />
                        <label for="star2" title="text">2 stars</label>
                        <input type="radio" id="star1" name="rate" value="1" />
                        <label for="star1" title="text">1 star</label>
                    </div>
                </div>

            </div>


        </div>




        <script>
            console.log('Hover content elements', document.getElementsByClassName(".hover-content"));
            const hoverContentElements = document.getElementsByClassName("hover-content");
            for (var i = 0; i < hoverContentElements.length; i++) {
                var id = hoverContentElements[i].id
                var hoverContent = hoverContentElements[i]
                hoverContentElements[i].addEventListener("click", function ja() {
                    var item1 = this.id
                    $.ajax({
                        type: "POST",
                        url: "/Index?handler=List",
                        beforeSend: function (xhr) {
                            xhr.setRequestHeader("XSRF-TOKEN",
                                $('input:hidden[name="__RequestVerificationToken"]').val());
                        },
                        data: JSON.stringify(
                            {
                                Item1: item1
                            }),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (response) {
                            var dvItems = $("#dvPostItems");
                            dvItems.empty();
                            $.each(response, function (i, item) {
                                var $tr = $('<li>').append(item).appendTo(dvItems);
                                $('#popup').load('/Index?handler=MealPartial');
                                document.querySelector(".popup").style.display = "flex";

                            });
                        },
                        failure: function (response) {
                            setTimeout(ja, 300)
                        }
                    })

                })

            }

        </script>

    </div>





</body>
